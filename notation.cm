(in-package :cm)

(defun play-chords (chords &optional (fn "output.midi"))
    (events
     (loop for chord in chords
	   for i = 0 then (+ i 1)
	   append (loop for note in chord
			collect (new midi :time i :keynum note :duration 1)))
     fn))

(play-chords
 '((c e g) (d f a) (g b5 e5) (c e g c5)))